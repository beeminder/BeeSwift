name: Fastlane Tests

on:
  pull_request:

jobs:
  build:
    runs-on: macos-latest

    steps:
    - uses: actions/checkout@v2
    - uses: ruby/setup-ruby@v1
      with:
        ruby-version: '2.7.2'
    - name: Use sample configuration
      run: cp BeeSwift/Config.swift.sample BeeKit/Config.swift
    - name: Run tests
      run: bundle install && bundle exec fastlane test
    - name: Publish Test Report
      uses: mikepenz/action-junit-report@v3
      if: always() # always run even if the previous step fails
      with:
        report_paths: 'fastlane/test_output/report.junit'
